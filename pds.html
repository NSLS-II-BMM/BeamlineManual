

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>7. Photon Delivery System &#8212; BMM Beamline Manual 0.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'pds';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="8. Sample position scans" href="linescans.html" />
    <link rel="prev" title="6. Moving and querying motors" href="motors.html" />

    <link rel="stylesheet" type="text/css" href="_static/demeter.css" />
    <link rel="stylesheet" type="text/css" href="_static/keys.css" />
    <link rel="stylesheet" type="text/css" href="_static/program.css" />
    <link rel="stylesheet" type="text/css" href="_static/color.css" />

  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/floor_mat.png" class="logo__image only-light" alt="BMM Beamline Manual 0.1 documentation - Home"/>
    <script>document.write(`<img src="_static/floor_mat.png" class="logo__image only-dark" alt="BMM Beamline Manual 0.1 documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">User documentation</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="intro.html">1. Introduction to BMM</a></li>
<li class="toctree-l1"><a class="reference internal" href="proposal.html">2. Proposal Writing for BMM</a></li>
<li class="toctree-l1"><a class="reference internal" href="before.html">3. Before your Beamtime</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">4. Data access</a></li>
<li class="toctree-l1"><a class="reference internal" href="instruments.html">5. Beamline instrumentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="motors.html">6. Moving and querying motors</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">7. Photon Delivery System</a></li>
<li class="toctree-l1"><a class="reference internal" href="linescans.html">8. Sample position scans</a></li>
<li class="toctree-l1"><a class="reference internal" href="xafs.html">9. XAFS scans</a></li>
<li class="toctree-l1"><a class="reference internal" href="other.html">10. Other measurement needs</a></li>
<li class="toctree-l1"><a class="reference internal" href="automation.html">11. Beamline automation</a></li>
<li class="toctree-l1"><a class="reference internal" href="log.html">12. Experimental Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="manage.html">13. Managing the beamline</a></li>
<li class="toctree-l1"><a class="reference internal" href="commonchores.html">14. Common chores</a></li>
<li class="toctree-l1"><a class="reference internal" href="cheatsheet.html">15. Command cheatsheet</a></li>
<li class="toctree-l1"><a class="reference internal" href="trouble.html">16. Troubleshooting</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Staff documentation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="desktop.html">A. BMM’s Desktop</a></li>
<li class="toctree-l1"><a class="reference internal" href="profile.html">B. An overview of BMM’s profile</a></li>
<li class="toctree-l1"><a class="reference internal" href="kafka.html">C. Kafka workers at BMM</a></li>
<li class="toctree-l1"><a class="reference internal" href="ionchambers.html">D. Ion chamber signal chains</a></li>
<li class="toctree-l1"><a class="reference internal" href="details.html">E. Instrumentation Details</a></li>
<li class="toctree-l1"><a class="reference internal" href="restore.html">F. Power outage recovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="photos.html">G. Photo Galleries</a></li>
<li class="toctree-l1"><a class="reference internal" href="todo.html">H. To Do List</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/NSLS2/bmm-beamline-manual" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/NSLS2/bmm-beamline-manual/issues/new?title=Issue%20on%20page%20%2Fpds.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/pds.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Photon Delivery System</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">7.1. Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configure-for-an-absorption-edge">7.2. Configure for an Absorption Edge</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#automating-reference-foil-changes">7.2.1. Automating reference foil changes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameters-for-the-change-edge-command">7.2.2. Parameters for the change_edge() command</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shutters">7.3. Shutters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#monochromator">7.4. Monochromator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#post-mono-slits">7.5. Post-mono slits</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mirrors">7.6. Mirrors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#end-station-slits">7.7. End station slits</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configurations">7.8. Configurations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#photon-delivery-modes">7.8.1. Photon delivery modes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monochromator-crystals">7.8.2. Monochromator crystals</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="photon-delivery-system">
<span id="pds"></span><h1><span class="section-number">7. </span>Photon Delivery System<a class="headerlink" href="#photon-delivery-system" title="Permalink to this heading">#</a></h1>
<section id="overview">
<h2><span class="section-number">7.1. </span>Overview<a class="headerlink" href="#overview" title="Permalink to this heading">#</a></h2>
<figure class="align-center" id="id4">
<span id="fig-bmm-schematic"></span><a class="reference external image-reference" href="_images/bmm-schematic.png"><img alt="_images/bmm-schematic.png" src="_images/bmm-schematic.png" style="width: 100%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 7.1 </span><span class="caption-text">Beamline optics layout for BMM.  Thanks to Tiffany Bowman for
this lovely beamline schematic.</span><a class="headerlink" href="#id4" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<dl>
<dt>Source</dt><dd><p>The source at BMM is an <a class="reference external" href="https://doi.org/10.1016/j.nima.2023.169008">NSLS-II three-pole wiggler (TPW)</a>.  (See
<a class="reference internal" href="photos.html#tpw"><span class="std std-numref">Section G.4</span></a> for some photos of the source device.)
This device has a spectrum that resembles a bending magnet, but
shifted to higher energy compared to the NSLS-II bending magnet.</p>
</dd>
<dt>Collimating Mirror</dt><dd><p>The first optical component is a paraboloid collimating mirror.
This device is 5 nm of Rh on 30 nm of Pt on a silicon substrate.
This fixed-angle, fixed-figure device corrects the dispersion of the
TPW source and directs the collimated beam toward the ratchet wall
aperture.</p>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>There is never a reason to move the first mirror.  It
is in the correct orientation for collimation and delivery of
beam through the ratchet wall.</p>
<p><span class="boldred">Moving any first mirror motor runs the risk of leaving the
first mirror in a non-functional state!</span></p>
</div>
</dd>
<dt>Monochromator</dt><dd><p>The collimated beam then hits the double crystal monochromator
(DCM).  BMM has pairs of Si(111) and Si(311) crystals, accessibly by
lateral translation of the DCM vacuum vessel.  This is a fixed-exit
monochromator which moves the second crystal parallel and
perpendicular to the crystal surfaces to direct the monochromatic
beam towards a small aperture in the pink beam mask and
Bremsstrahlung shield.</p>
</dd>
<dt>Focusing and harmonic rejection mirrors</dt><dd><p>Downstream of the monochromator are a torroidal focusing mirror
(TFM) and a flat harmonic rejection mirror (HRM).  The TFM is coated
with 5 nm of Rh on 30 nm of Pt.  The HRM has a Rh/Pt stripe and a
bare silicon stripe.  The bare silicon stripe is used below 8 keV
for improved harmonic rejection.</p>
<p>The angle and bend of the TFM can be adjusted to deliver focused
beam either to the XAS end station or to the center of the
goniometer.</p>
<p>At high energies, either the TFM or the HRM is in the beam path.  At
low energies, the HRM or both mirrors are in use.  See
<a class="reference internal" href="#change-mode"><span class="std std-numref">Section 7.8.1</span></a> for details of the mirror
configuration modes.</p>
</dd>
</dl>
<p>See <a class="reference external" href="https://doi.org/10.1107/S0909049504005837">MA Marcus, et al., J. Synch. Radiat. (2004) 11, 239-247</a> for an explanation of
the Pt/Rh coating scheme.</p>
</section>
<section id="configure-for-an-absorption-edge">
<span id="change-edge"></span><h2><span class="section-number">7.2. </span>Configure for an Absorption Edge<a class="headerlink" href="#configure-for-an-absorption-edge" title="Permalink to this heading">#</a></h2>
<p>Configuring the photon delivery system for a specific measurement is
usually quite simple.  When moving to a new absorption edge, do the
following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">RE</span><span class="p">(</span><span class="n">change_edge</span><span class="p">(</span><span class="s1">&#39;Fe&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>substituting the two-letter symbol for the element you want to
measure.  This will:</p>
<ul class="simple">
<li><p>move the monochromator <a class="reference internal" href="#dcm"><span class="std std-numref">(Section 7.4)</span></a></p></li>
<li><p>put the photon delivery system in the correct mode <a class="reference internal" href="#change-mode"><span class="std std-numref">(Section
7.8.1)</span></a></p></li>
<li><p>measure the rocking curve of the monochromator <a class="reference internal" href="linescans.html#special-linescans"><span class="std std-numref">(Section 8.2)</span></a></p></li>
<li><p>optimize the height of the hutch slits <a class="reference internal" href="linescans.html#special-linescans"><span class="std std-numref">(Section 8.2)</span></a></p></li>
<li><p>move the reference foil holder to the correct position
<a class="reference internal" href="motors.html#sample-stages"><span class="std std-numref">(Section 6.1)</span></a></p></li>
<li><p>set the active Xspress3 ROI to the correct emission line</p></li>
</ul>
<p>This whole process takes at most 7 minutes, sometimes under 3
minutes.  After that, the beamline is ready to collect data.</p>
<p>If using the focusing mirror, do this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">RE</span><span class="p">(</span><span class="n">change_edge</span><span class="p">(</span><span class="s1">&#39;Fe&#39;</span><span class="p">,</span> <span class="n">focus</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
<p>Excluding the <code class="docutils literal notranslate"><span class="pre">focus</span></code> argument – or setting it to False –
indicates setup for collimated beam.</p>
<p>This edge change can be put into a <a class="reference internal" href="xafs.html#macro"><span class="std std-numref">macro (see Section 9.6)</span></a> like so:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">yield from</span> <span class="n">change_edge</span><span class="p">(</span><span class="s1">&#39;Fe&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">yield from</span> <span class="n">change_edge</span><span class="p">(</span><span class="s1">&#39;Fe&#39;</span><span class="p">,</span> <span class="n">focus</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>In this way, a macro can manage energy changes while you sleep!</p>
<section id="automating-reference-foil-changes">
<span id="foilholder"></span><h3><span class="section-number">7.2.1. </span>Automating reference foil changes<a class="headerlink" href="#automating-reference-foil-changes" title="Permalink to this heading">#</a></h3>
<p>A wheel is used to hold and switch between reference foils and stable
oxides.  The standard reference wheel has most of the elements
accessible at BMM, including all the lanthanides (except Pm!).  A
double wheel (<a class="reference internal" href="automation.html#fig-doublewheel"><span class="std std-numref">see Figure 11.2</span></a>) is used to
hold the standards.  The wheel is mounted on a rotation stage which
is, in turn, mounted on an XY stage for alignment.  See
<a class="reference internal" href="xafs.html#tab-reference-wheel"><span class="std std-numref">Table 9.2</span></a> for the contents of reference
wheel.</p>
<figure class="align-center" id="id5">
<span id="fig-ref-wheel"></span><a class="reference external image-reference" href="_images/ref_wheel.jpg"><img alt="_images/ref_wheel.jpg" src="_images/ref_wheel.jpg" style="width: 50%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 7.2 </span><span class="caption-text">The reference wheel.</span><a class="headerlink" href="#id5" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>To select, for example, the iron reference foil:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">RE</span><span class="p">(</span><span class="n">reference</span><span class="p">(</span><span class="s1">&#39;Fe&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>In a plan:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">yield from</span> <span class="n">reference</span><span class="p">(</span><span class="s1">&#39;Fe&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The argument is simply the one- or two-element symbol for the target
element.</p>
<p>This selects the correct reference by rotating to the correct slot and
translating to the correct ring on the wheel.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">change_edge()</span></code> command does this automatically, so long as the
target edge is available on the reference holder.</p>
<p>The reference wheel content is configured as a python dictionary.  See
<code class="docutils literal notranslate"><span class="pre">xafs_ref.mapping</span></code>, <a class="reference external" href="https://github.com/NSLS2/bmm-profile-collection/blob/main/startup/BMM/user_ns/instruments.py#L323">defined here</a>.</p>
<p>This dictionary identifies the positions in <code class="docutils literal notranslate"><span class="pre">xafs_ref</span></code> and
<code class="docutils literal notranslate"><span class="pre">xafs_refx</span></code> for each reference sample.  It also identifies the form
of the reference samples and its chemical composition.</p>
<p>To see the available reference materials and their positions on the
reference wheel, do <code class="docutils literal notranslate"><span class="pre">%se</span></code>.</p>
<p><a class="reference external" href="https://nsls2.github.io/bmm-standards/BMM-standards.html">Here is a complete list of standards</a> in
BMM’s collection.</p>
</section>
<section id="parameters-for-the-change-edge-command">
<h3><span class="section-number">7.2.2. </span>Parameters for the change_edge() command<a class="headerlink" href="#parameters-for-the-change-edge-command" title="Permalink to this heading">#</a></h3>
<p>Typically the <code class="docutils literal notranslate"><span class="pre">change_edge()</span></code> command is called with one or two
arguments, the mandatory element symbol and the the <code class="docutils literal notranslate"><span class="pre">focus</span></code>
argument, which can be <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>The full set of parameters for the <code class="docutils literal notranslate"><span class="pre">change_edge()</span></code> plan are:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">RE</span><span class="p">(</span><span class="n">change_edge</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">focus</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">edge</span><span class="o">=</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="n">energy</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tune</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">slits</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">calibrating</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="mf">300.</span><span class="p">))</span>
</pre></div>
</div>
<p>where,</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">element</span></code></dt><dd><p>The one- or two-letter element symbol or Z number.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">focus</span></code></dt><dd><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: set up for using the focusing mirror, modes A, B, C;
<code class="docutils literal notranslate"><span class="pre">False</span></code>: collimated beam, modes D, E, F.  Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">edge</span></code></dt><dd><p>If not specified, use K or L3, as appropriate for the energy range
of the beamline.  Use this argument to specify an L1, L2, or M edge.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">energy</span></code></dt><dd><p>Use an E0 value that is not obtained from the look-up table.
Default is unspecified, i.e. use <code class="docutils literal notranslate"><span class="pre">element</span></code> and look-up table.
This is rarely necessary, except when <a class="reference internal" href="manage.html#xas-to-xrd"><span class="std std-numref">setting up for XRD
(Section 13.4)</span></a>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">insist</span></code></dt><dd><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: Force movement of M2 motors; <code class="docutils literal notranslate"><span class="pre">False</span></code>: decide normally
whether to move M2 motors.  Default is <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">tune</span></code></dt><dd><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: optimize DCM second crystal pitch; <code class="docutils literal notranslate"><span class="pre">False</span></code>: skip <code class="docutils literal notranslate"><span class="pre">rocking_curve()</span></code>
scan.  Default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.  Skipping this is rarely a good idea.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">slits</span></code></dt><dd><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: optimize slit height; <code class="docutils literal notranslate"><span class="pre">False</span></code>: skip <code class="docutils literal notranslate"><span class="pre">slit_hight()</span></code>
scan.  Default is <code class="docutils literal notranslate"><span class="pre">True</span></code>.  Skipping this is rarely a good idea.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">no_ref</span></code></dt><dd><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: skip moving to the correct reference foil.  Default is
<code class="docutils literal notranslate"><span class="pre">False</span></code>.  Used when the reference stages have been repurposed
for other use in an experiment.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">calibrating</span></code></dt><dd><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: used when performing beamline maintenance.  Default is
<code class="docutils literal notranslate"><span class="pre">False</span></code>.  Rarely used.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">target</span></code></dt><dd><p>The energy above e0 at which to perform the rocking curve scan.
Default is 300.  Care is taken not to exceed an L<sub>2</sub> edge
energy (or L<sub>1</sub> when measuring L<sub>2</sub>).</p>
</dd>
</dl>
<p>Except for <code class="docutils literal notranslate"><span class="pre">edge</span></code> and <code class="docutils literal notranslate"><span class="pre">focus</span></code>, most of those parameters are rarely
used.  If you need to measure an L<sub>2</sub> or L<sub>1</sub> edge, you
must specify <code class="docutils literal notranslate"><span class="pre">edge</span></code>.  For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">RE</span><span class="p">(</span><span class="n">change_edge</span><span class="p">(</span><span class="s1">&#39;Pt&#39;</span><span class="p">,</span> <span class="n">edge</span><span class="o">=</span><span class="s1">&#39;L1&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>For all the details about the individual parts of the photon delivery
system, read on!</p>
</section>
</section>
<section id="shutters">
<span id="id1"></span><h2><span class="section-number">7.3. </span>Shutters<a class="headerlink" href="#shutters" title="Permalink to this heading">#</a></h2>
<dl>
<dt><strong>Open and close the photon shutter</strong></dt><dd><p>In the nomenclature of BMM, the photon shutter is <code class="docutils literal notranslate"><span class="pre">shb</span></code>.  Open
and close this shutter with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">shb</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
<span class="n">shb</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>These plans are somewhat more elaborate than simply toggling the
state of the shutters.  It happens from time to time that the
shutter does not trigger when told to open or close.  So, these
plans try up to three times to open or close the photon shutter,
with a 1.5 second pause between attempts.</p>
<p>If you wish to open or close the photon shutter (using the same
multiple attempt algorithm) in a <a class="reference internal" href="xafs.html#macro"><span class="std std-numref">macro (Section 9.6)</span></a>, do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">yield from</span> <span class="n">shb</span><span class="o">.</span><span class="n">open_plan</span><span class="p">()</span>
<span class="k">yield from</span> <span class="n">shb</span><span class="o">.</span><span class="n">close_plan</span><span class="p">()</span>
</pre></div>
</div>
</dd>
<dt><strong>Open and close the safety shutter</strong></dt><dd><p>This is the front-end shutter.  Closing it takes light off the
monochromator, which is not something you typically want to do
during an experiment.  That said, the safety shutter is <code class="docutils literal notranslate"><span class="pre">sha</span></code> in
the BMM nomenclature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sha</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
<span class="n">sha</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>and:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">yield from</span> <span class="n">sha</span><span class="o">.</span><span class="n">open_plan</span><span class="p">()</span>
<span class="k">yield from</span> <span class="n">sha</span><span class="o">.</span><span class="n">close_plan</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
</section>
<section id="monochromator">
<span id="dcm"></span><h2><span class="section-number">7.4. </span>Monochromator<a class="headerlink" href="#monochromator" title="Permalink to this heading">#</a></h2>
<p>The monochromator consists of 8 motors.  It should never be necessary
to interact directly with any of the physical motors.  Plans exist for
facilitating any actions a user should ever need.</p>
<dl>
<dt><strong>Query the current energy</strong></dt><dd><p>To know the position and energy of the monochromator: <code class="docutils literal notranslate"><span class="pre">%w</span> <span class="pre">dcm</span></code></p>
<p>This returns a short report like this:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Energy = 19300.1   reflection = Si(111)
current: Bragg =  5.87946   2nd Xtal Perp = 15.0792   2nd Xtal Para = 146.4328
</pre></div>
</div>
<p>This report shows the current energy, the crystal set currently in
use, and the position of the parallel and perpendicular motors of
the second crystal carriage.</p>
</dd>
<dt><strong>Move to a new energy</strong></dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">dcm.energy</span></code> virtual motor coordinates the Bragg, parallel,
and perpendicular motors to maintain a fixed exit height and set
the energy of the mono.  To move to the copper K edge energy:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RE</span><span class="p">(</span><span class="n">mv</span><span class="p">(</span><span class="n">dcm</span><span class="o">.</span><span class="n">energy</span><span class="p">,</span> <span class="mi">8979</span><span class="p">))</span>
</pre></div>
</div>
<p>To move 50 eV above the copper K edge energy:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RE</span><span class="p">(</span><span class="n">mv</span><span class="p">(</span><span class="n">dcm</span><span class="o">.</span><span class="n">energy</span><span class="p">,</span> <span class="mi">8979</span><span class="o">+</span><span class="mi">50</span><span class="p">))</span>
</pre></div>
</div>
<p>Note that the BlueSky command line is able to do simple arithmetic
(and a whole lot more!).  It is a good idea to leave the arithmetic
to the computer.</p>
</dd>
<dt><strong>Move to a new energy in a macro</strong></dt><dd><p>An energy change can be a part of a <a class="reference internal" href="xafs.html#macro"><span class="std std-numref">macro (Section 9.6)</span></a>.  Simply do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">yield from</span> <span class="n">mv</span><span class="p">(</span><span class="n">dcm</span><span class="o">.</span><span class="n">energy</span><span class="p">,</span> <span class="mi">8979</span><span class="o">+</span><span class="mi">50</span><span class="p">))</span>
</pre></div>
</div>
</dd>
<dt><strong>Tune the second crystal of the mono</strong></dt><dd><p>After a long move, you might need to retune the second crystal.  To
find the peak of the rocking curve and move to that peak:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RE</span><span class="p">(</span><span class="n">rocking_curve</span><span class="p">())</span>
</pre></div>
</div>
<p>This will run a scan of the pitch of the second crystal.  At the
end of the scan, it moves to the center of mass of the measured
intensity profile.</p>
<p>You can do the rocking curve scan by looking at the signal on the
Bicron which is used as the incident beam monitor for the XRD end
station.  Do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RE</span><span class="p">(</span><span class="n">rocking_curve</span><span class="p">(</span><span class="n">detector</span><span class="o">=</span><span class="s1">&#39;Bicron&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>You can tune the second crystal by hand with these commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tu</span><span class="p">()</span>
<span class="n">td</span><span class="p">()</span>
</pre></div>
</div>
<p>Those stand for “tune up” and “tune down”.  Do not
think that “up” and “down” refer to measured
intensity.  Rather, they refer to the direction of motion of the
motor which adjusts the second crystal pitch.  When you move to
higher energy, you usually need to tune in <code class="docutils literal notranslate"><span class="pre">td()</span></code> direction.
When you move to a lower energy, you usually need to tune in the
<code class="docutils literal notranslate"><span class="pre">tu()</span></code> direction.  Obviously…..</p>
</dd>
<dt><strong>Fixed-exit and pseudo-channelcut modes</strong></dt><dd><p>The mono can be run in either fixed-exit or pseudo-channelcut
modes.</p>
<p>Fixed exit means that the second monochromator crystal will be
moved in directions parallel and perpendicular to its diffracting
surface in order to maintain a fixed exit height of the beam coming
from the second crystal.  Without fixed-exit mode, it would not be
possible to change the energy over the entire energy range of the
beamline.  The aperture after the monochromator is only a few
millimeters tall.  The vertical displacement of the beam over a
lerge energy change would be sufficient to move the beam out of the
aperture.</p>
<p>However, the stability of the monochromator suffers with respect to
EXAFS data quality when measuring an energy scan in fixed-exit
mode.  We find it is better to disable the parallel and
perpendicular motions when measuring XAFS, suffering a small
vertical displacement of the beam.</p>
<p>The mono mode is controlled by a parameter:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dcm</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;fixed&#39;</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dcm</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;channelcut&#39;</span>
</pre></div>
</div>
<p>In practice, the monochromator is normally left in fixed-exit mode.
That way, the monochromator can be moved without having to worry
about the beam height and the monochromator exit aperture.  In the
<a class="reference internal" href="xafs.html#xafsscan"><span class="std std-numref">XAFS scan plan (Section 9.4)</span></a>, the monochromator
first moves – in fixed-exit mode – to the center of the
angular range of the scan, then sets <code class="docutils literal notranslate"><span class="pre">dcm.mode</span></code> to
<code class="docutils literal notranslate"><span class="pre">channelcut</span></code>. Once the sequence of scan repititions is finished,
the monochromator is moved back to the center of the angular range
and the monochromator is returned to fixed-exit mode.</p>
</dd>
</dl>
</section>
<section id="post-mono-slits">
<span id="slits"></span><h2><span class="section-number">7.5. </span>Post-mono slits<a class="headerlink" href="#post-mono-slits" title="Permalink to this heading">#</a></h2>
<p>After the mono, before the focusing mirror, in Diagnostic Module 2,
there is a four-blade slit system.  These are used to define the beam
size on the mirrors and to refine energy resolution for the focused
beam.</p>
<p>The typical size of the post-mono slits is 18 mm in the horizontal and
1.3 mm in the vertical.</p>
<div class="pst-scrollable-table-container"><table class="table table-left" id="slits2-motors">
<caption><span class="caption-number">Table 7.1 </span><span class="caption-text">Post mono slit motors</span><a class="headerlink" href="#slits2-motors" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>motor</p></th>
<th class="head"><p>units</p></th>
<th class="head"><p>notes</p></th>
<th class="head"><p>motion type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>slits2_top</p></td>
<td><p>mm</p></td>
<td><p>top blade position</p></td>
<td><p>single axis</p></td>
</tr>
<tr class="row-odd"><td><p>slits2_bottom</p></td>
<td><p>mm</p></td>
<td><p>bottom blade position</p></td>
<td><p>single axis</p></td>
</tr>
<tr class="row-even"><td><p>slits2_inboard</p></td>
<td><p>mm</p></td>
<td><p>inboard blade position</p></td>
<td><p>single axis</p></td>
</tr>
<tr class="row-odd"><td><p>slits2_outboard</p></td>
<td><p>mm</p></td>
<td><p>outboard blade position</p></td>
<td><p>single axis</p></td>
</tr>
<tr class="row-even"><td><p>slits2_hsize</p></td>
<td><p>mm</p></td>
<td><p>horizontal size</p></td>
<td><p>coordinated motion</p></td>
</tr>
<tr class="row-odd"><td><p>slits2_hcenter</p></td>
<td><p>mm</p></td>
<td><p>horizontal center</p></td>
<td><p>coordinated motion</p></td>
</tr>
<tr class="row-even"><td><p>slits2_vsize</p></td>
<td><p>mm</p></td>
<td><p>vertical size</p></td>
<td><p>coordinated motion</p></td>
</tr>
<tr class="row-odd"><td><p>slits2_vcenter</p></td>
<td><p>mm</p></td>
<td><p>vertical center</p></td>
<td><p>coordinated motion</p></td>
</tr>
</tbody>
</table>
</div>
<p>The individual blades are moved like any other motor:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RE</span><span class="p">(</span><span class="n">mv</span><span class="p">(</span><span class="n">slits2</span><span class="o">.</span><span class="n">outboard</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
<span class="n">RE</span><span class="p">(</span><span class="n">mvr</span><span class="p">(</span><span class="n">slits2</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">))</span>
</pre></div>
</div>
<p>Coordinated motions are moved the same way:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RE</span><span class="p">(</span><span class="n">mv</span><span class="p">(</span><span class="n">slits2</span><span class="o">.</span><span class="n">hsize</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">RE</span><span class="p">(</span><span class="n">mvr</span><span class="p">(</span><span class="n">slits2</span><span class="o">.</span><span class="n">vcenter</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">))</span>
</pre></div>
</div>
<p>To know the current positions of the slit blades and their coordinated
motions, use <code class="docutils literal notranslate"><span class="pre">%w</span> <span class="pre">slits2</span></code></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>In [1966]: %w slits2
SLITS2:
     vertical   size   =   1.350 mm          Top      =   0.675
     vertical   center =   0.000 mm          Bottom   =  -0.675
     horizontal size   =   8.000 mm          Outboard =   4.000
     horizontal center =   0.000 mm          Inboard  =  -4.000
</pre></div>
</div>
</section>
<section id="mirrors">
<h2><span class="section-number">7.6. </span>Mirrors<a class="headerlink" href="#mirrors" title="Permalink to this heading">#</a></h2>
<p>Mirrors are set as part of the mode changing plan.  Unless you know
exactly what you are doing, you probably don’t want to move the
mirrors outside of the <code class="docutils literal notranslate"><span class="pre">change_mode()</span></code> command.  (Adjusting M1 by
hand is a horrible idea – unless you know exactly what you are doing
and why.)  Changing the mirror positions in any way changes the height
and inclination of the beam as it enters the end station.  This
requires changes in positions of the slits, the XAFS table, and other
parts of the photon delivery system.</p>
<p>Outside of the use of the <code class="docutils literal notranslate"><span class="pre">change_mode()</span></code> command, it should not be
necessary for users to move the mirror motors.  It is <strong>very easy</strong> to
lose the beam entirely when moving mirror motors.  Without a clear
understanding of how the optics work, re-finding the beam can be quite
challenging.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>If you loose the beam by moving mirror motors, the
easiest solution is to rerun the <code class="docutils literal notranslate"><span class="pre">change_mode()</span></code> command,
possibly with the <code class="docutils literal notranslate"><span class="pre">insist=True</span></code> argument.</p>
</div>
<p>If you want to know the current positions of the motors on the
focusing mirror, use <code class="docutils literal notranslate"><span class="pre">%w</span> <span class="pre">m2</span></code></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>In [1903]: %w m2
M2:
     vertical =   6.000 mm           YU  =   6.000
     lateral  =   0.000 mm           YDO =   6.000
     pitch    =   0.000 mrad         YDI =   6.000
     roll     =  -0.001 mrad         XU  =  -0.129
     yaw      =   0.200 mrad         XD  =   0.129
     bender   =  163789.0 steps
</pre></div>
</div>
<p>For the harmonic rejection mirror, use <code class="docutils literal notranslate"><span class="pre">%w</span> <span class="pre">m3</span></code></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>In [1904]: %w m3
M3: (Rh/Pt stripe)
     vertical =   0.000 mm           YU  =  -1.167
     lateral  =  15.001 mm           YDO =   1.167
     pitch    =   3.500 mrad         YDI =   1.167
     roll     =   0.000 mrad         XU  =  15.001
     yaw      =   0.001 mrad         XD  =  15.001
</pre></div>
</div>
<p>The front-end collimating mirror, the focusing mirror, and one stripe
of the harmonic rejection mirror are coated with 5 nm of Rh deposited
on 30 nm of Pt on silicon.  See <a class="reference external" href="https://doi.org/10.1107/S0909049504005837">MA Marcus, et
al., J. Synch. Radiat. (2004) 11, 239-247 DOI:
10.1107/S0909049504005837</a> for an explanation of
the advantages of this coating scheme.</p>
</section>
<section id="end-station-slits">
<span id="slits3"></span><h2><span class="section-number">7.7. </span>End station slits<a class="headerlink" href="#end-station-slits" title="Permalink to this heading">#</a></h2>
<p>Near the end of the photon delivery system, in Diagnostic Module 3 in
the end station, there is a four-blade slit system.  These are used
to define the beam size on the sample.</p>
<div class="pst-scrollable-table-container"><table class="table table-left" id="slits3-motors">
<caption><span class="caption-number">Table 7.2 </span><span class="caption-text">End station slit motors</span><a class="headerlink" href="#slits3-motors" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>motor</p></th>
<th class="head"><p>units</p></th>
<th class="head"><p>notes</p></th>
<th class="head"><p>motion type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>slits3_top</p></td>
<td><p>mm</p></td>
<td><p>top blade position</p></td>
<td><p>single axis</p></td>
</tr>
<tr class="row-odd"><td><p>slits3_bottom</p></td>
<td><p>mm</p></td>
<td><p>bottom blade position</p></td>
<td><p>single axis</p></td>
</tr>
<tr class="row-even"><td><p>slits3_inboard</p></td>
<td><p>mm</p></td>
<td><p>inboard blade position</p></td>
<td><p>single axis</p></td>
</tr>
<tr class="row-odd"><td><p>slits3_outboard</p></td>
<td><p>mm</p></td>
<td><p>outboard blade position</p></td>
<td><p>single axis</p></td>
</tr>
<tr class="row-even"><td><p>slits3_hsize</p></td>
<td><p>mm</p></td>
<td><p>horizontal size</p></td>
<td><p>coordinated motion</p></td>
</tr>
<tr class="row-odd"><td><p>slits3_hcenter</p></td>
<td><p>mm</p></td>
<td><p>horizontal center</p></td>
<td><p>coordinated motion</p></td>
</tr>
<tr class="row-even"><td><p>slits3_vsize</p></td>
<td><p>mm</p></td>
<td><p>vertical size</p></td>
<td><p>coordinated motion</p></td>
</tr>
<tr class="row-odd"><td><p>slits3_vcenter</p></td>
<td><p>mm</p></td>
<td><p>vertical center</p></td>
<td><p>coordinated motion</p></td>
</tr>
</tbody>
</table>
</div>
<p>The individual blades are moved like any other motor, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RE</span><span class="p">(</span><span class="n">mv</span><span class="p">(</span><span class="n">slits3</span><span class="o">.</span><span class="n">outboard</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">))</span>
<span class="n">RE</span><span class="p">(</span><span class="n">mvr</span><span class="p">(</span><span class="n">slits3</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">))</span>
</pre></div>
</div>
<p>Coordinated motions are moved the same way, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RE</span><span class="p">(</span><span class="n">mv</span><span class="p">(</span><span class="n">slits3</span><span class="o">.</span><span class="n">hsize</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">RE</span><span class="p">(</span><span class="n">mvr</span><span class="p">(</span><span class="n">slits3</span><span class="o">.</span><span class="n">vcenter</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">))</span>
</pre></div>
</div>
<p>To know the current positions of the slit blades and their coordinated
motions, use <code class="docutils literal notranslate"><span class="pre">%w</span> <span class="pre">slits3</span></code></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>In [1966]: %w slits3
SLITS3:
     vertical   size   =   1.350 mm          Top      =   0.675
     vertical   center =   0.000 mm          Bottom   =  -0.675
     horizontal size   =   8.000 mm          Outboard =   4.000
     horizontal center =   0.000 mm          Inboard  =  -4.000
</pre></div>
</div>
</section>
<section id="configurations">
<h2><span class="section-number">7.8. </span>Configurations<a class="headerlink" href="#configurations" title="Permalink to this heading">#</a></h2>
<section id="photon-delivery-modes">
<span id="change-mode"></span><h3><span class="section-number">7.8.1. </span>Photon delivery modes<a class="headerlink" href="#photon-delivery-modes" title="Permalink to this heading">#</a></h3>
<p>A look-up table is used to move the elements of the photon delivery
system to their correct locations for the different energy ranges and
focusing conditions.  Here is a table of different photon delivery
modes.  Modes A-F are for delivery of light to the XAS end station.
Mode XRD delivers high energy, focused beam to the goniometer.</p>
<div class="pst-scrollable-table-container"><span id="id2"></span><table class="table table-left" id="pds-modes">
<caption><span class="caption-number">Table 7.3 </span><span class="caption-text">Photon delivery modes</span><a class="headerlink" href="#pds-modes" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Mode</p></th>
<th class="head"><p>focused</p></th>
<th class="head"><p>energy range</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>A</p></td>
<td><p>✓</p></td>
<td><p>above 8 keV</p></td>
</tr>
<tr class="row-odd"><td><p>B</p></td>
<td><p>✓</p></td>
<td><p>below 6 keV</p></td>
</tr>
<tr class="row-even"><td><p>C</p></td>
<td><p>✓</p></td>
<td><p>6 keV – 8 keV</p></td>
</tr>
<tr class="row-odd"><td><p>D</p></td>
<td><p>✗</p></td>
<td><p>above 8 keV</p></td>
</tr>
<tr class="row-even"><td><p>E</p></td>
<td><p>✗</p></td>
<td><p>6 keV – 8 keV</p></td>
</tr>
<tr class="row-odd"><td><p>F</p></td>
<td><p>✗</p></td>
<td><p>below 6 keV</p></td>
</tr>
<tr class="row-even"><td><p>XRD</p></td>
<td><p>✓</p></td>
<td><p>above 8 keV</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition-todo admonition" id="id3">
<p class="admonition-title">Todo</p>
<p>The lookup table is not complete for mode B. In fact, the
ydo and ydi jacks of M3 cannot move low enough to enter mode B.  In
practice, mode B is not available.  Elements that should be
measured in mode B are, instead, measured in mode C and we live
with incomplete harmonic rejection.</p>
</div>
<p>To move between modes, do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RE</span><span class="p">(</span><span class="n">change_mode</span><span class="p">(</span><span class="s1">&#39;&lt;mode&gt;&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">&lt;mode&gt;</span></code> is one of the strings in the first column of
<a class="reference internal" href="#pds-modes"><span class="std std-numref">Table 7.3</span></a>.  For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RE</span><span class="p">(</span><span class="n">change_mode</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>This will move 17 motors all at the same time and should take less
than 5 minutes.</p>
<p>Focusing at the XAS end station requires that bender be near its upper
limit.  Focusing at the XRD station has the bender near the middle of
its range.</p>
</section>
<section id="monochromator-crystals">
<span id="change-crystals"></span><h3><span class="section-number">7.8.2. </span>Monochromator crystals<a class="headerlink" href="#monochromator-crystals" title="Permalink to this heading">#</a></h3>
<p>To change between the Si(111) and Si(311) crystals, do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RE</span><span class="p">(</span><span class="n">change_xtals</span><span class="p">(</span><span class="s1">&#39;111&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RE</span><span class="p">(</span><span class="n">change_xtals</span><span class="p">(</span><span class="s1">&#39;311&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>This will move the lateral motor of the monochromator between the two
crystal sets and adjust the pitch of the second crystal to be nearly
in tune and the roll to deliver the beam to nearly the same location
for both crystals.  It will also return the monochromator to the
starting energy.</p>
<p>This takes about 5 minutes.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">change_xtals()</span></code> plan also runs the <a class="reference internal" href="linescans.html#special-linescans"><span class="std std-numref">rocking curve
(Section 8.2)</span></a> macro to fix the tuning of the
second crystal.</p>

<br>
</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="motors.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">6. </span>Moving and querying motors</p>
      </div>
    </a>
    <a class="right-next"
       href="linescans.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">8. </span>Sample position scans</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">7.1. Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configure-for-an-absorption-edge">7.2. Configure for an Absorption Edge</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#automating-reference-foil-changes">7.2.1. Automating reference foil changes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parameters-for-the-change-edge-command">7.2.2. Parameters for the change_edge() command</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#shutters">7.3. Shutters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#monochromator">7.4. Monochromator</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#post-mono-slits">7.5. Post-mono slits</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mirrors">7.6. Mirrors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#end-station-slits">7.7. End station slits</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configurations">7.8. Configurations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#photon-delivery-modes">7.8.1. Photon delivery modes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#monochromator-crystals">7.8.2. Monochromator crystals</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Bruce Ravel
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>